import{D as x}from"./Dropdownlist.1b365210.js";import{W as g,c,b as e,e as u,x as $,Z as b,aL as v,i as w,d as f,aM as m,w as k,v as n,ae as D,o as h,H as C}from"./entry.5eee13ba.js";import"./_plugin-vue_export-helper.c27b6911.js";const V={key:0,class:"fixed inset-0 overflow-hidden","aria-labelledby":"slide-over-title",role:"dialog","aria-modal":"true"},U={class:"absolute inset-0 overflow-hidden"},R=e("div",{class:"absolute inset-0","aria-hidden":"true"},null,-1),j={class:"absolute inset-y-0 right-0 pl-10 max-w-full flex"},S={class:"w-screen max-w-md"},B={class:"h-full divide-y divide-gray-200 flex flex-col bg-white shadow-xl"},q={class:"flex-1 h-0 overflow-y-auto"},A={class:"space-y-1 py-6 px-4 bg-primary-200 bg-opacity-50 sm:px-6"},I={class:"flex items-center justify-between space-x-3"},M=e("h2",{class:"text-lg leading-7 font-medium text-gray-700"},"Department",-1),N={class:"h-7 flex items-center"},O=e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),E=[O],Z=e("div",null,[e("p",{class:"text-sm leading-5 text-gray-500"},"Create or update Department")],-1),z={key:0,class:"flex-1 flex flex-col justify-between"},L=C('<div class="space-y-6 pt-6 pb-5"><div class="flex justify-center"><span class="inline-flex"><button type="button" class="inline-flex items-center px-6 py-3 text-base font-medium text-gray-600"><svg class="-ml-1 mr-3 h-5 w-5 animate-spin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true"><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing... </button></span></div></div>',1),P=[L],W={key:1,class:"flex-1 flex flex-col justify-between"},F={class:"px-4 divide-y divide-gray-200 sm:px-6"},H={class:"space-y-6 pt-6 pb-5"},T={class:"sm:overflow-hidden"},G={class:"bg-white space-y-6"},J={class:"grid grid-cols-1 gap-y-3 gap-x-4 sm:grid-cols-6"},K={class:"sm:col-span-6"},Q=e("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Name",-1),X={class:"mt-1"},Y={class:"sm:col-span-6"},ee=e("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Code",-1),te={class:"mt-1"},se=e("p",{class:"mt-2 text-sm text-gray-500"},"Custom code used as unique constraint. If the same string exists will be thrown duplicate record error.",-1),ae={class:"sm:col-span-6"},oe={class:"sm:col-span-6"},ie={class:"w-full flex-shrink-0 px-4 py-4 space-x-4 flex justify-end"},ne=e("span",{class:"inline-flex rounded-md shadow-sm"},[e("button",{type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Reset")],-1),re={key:0,class:"inline-flex rounded-md shadow-sm"},le={class:"inline-flex rounded-md shadow-sm"};let y="/api/departments/";const de={components:{},data(){return{isUpsertDepartmentVisible:!1,isDeleteButtonVisible:!1,data:{},date:new Date,progress:!1}},methods:{getDepartment(o){this.progress=!0;const{data:s}=m(y+o,{method:"post",initialCache:!1,onResponse({request:l,response:r,options:d}){console.log("Response from promise",r._data.document),this.data=r._data.document,this.progress=!1}},"$RUOItkB3Oh");k(s,()=>{console.log("Department = ",JSON.stringify(s)),this.data=s._rawValue.document,this.isDeleteButtonVisible=!0,this.progress=!1})},async upsertDepartment(o){try{if(this.progress=!0,this.data._id===void 0){this.data.createdAt=n().$dayjs().utc(),this.data.updatedAt=n().$dayjs().utc();const{data:s}=await m(y+"create",{method:"post",body:this.data,initialCache:!1,onResponse({request:l,response:r,options:d}){r._data.insertedId&&n().$toast.show({type:"success",message:`Department [${r._data.insertedId}] added successfully`,timeout:6})}},"$p26WCDi8ZV")}else{const{data:s}=await m(y+this.data._id,{method:"put",body:_.omit(this.data,"_id"),initialCache:!1,onResponse({request:l,response:r,options:d}){r._data.modifiedCount>0&&n().$toast.show({type:"success",message:"Record has been updated successfully",timeout:6})}},"$Z5CtyEykGF")}this.progress=!1,n().$bus.$emit("evtSearchDepartment",{filter:{},limit:10}),this.data={},this.isUpsertDepartmentVisible=!this.isUpsertDepartmentVisible}catch(s){console.log(s),this.progress=!1}finally{}},async deleteDepartment(){try{await m("/api/departments/"+this.data._id,{method:"delete",body:{},initialCache:!1,onResponse({request:o,response:s,options:l}){s._data.deletedCount==1?(console.log("deletedCount = ",s._data.deletedCount),n().$toast.show({type:"success",message:"Delete was successful",timeout:6}),this.progress=!1,this.isUpsertDepartmentVisible=!1,n().$bus.$emit("evtSearchDepartment",{filter:{},limit:10}),this.data={}):(this.progress=!1,n().$toast.show({type:"error",message:"The delete failed...",timeout:6}))}},"$vOrERZ30c7")}catch{}finally{}},async closeDepartmentPanel(){this.data={},this.isUpsertDepartmentVisible=!this.isUpsertDepartmentVisible},handleSelectedInDepartment_record_status(o){this.data.record_status=o.target.value},handleSelectedInDepartment_mark_as_delete(o){this.data.mark_as_delete=o.target.value}},created(){n().$bus.$on("evtUpsertDepartment",o=>{o!==void 0&&this.getDepartment(o._cells[0].data),this.isUpsertDepartmentVisible=!this.isUpsertDepartmentVisible}),n().$bus.$on("evtDeleteDepartment",o=>{o!==void 0&&(this.data=o,this.deleteDepartment())})},beforeDestroy(){n().$bus.$off("evtUpsertDepartment"),n().$bus.$off("evtDeleteDepartment")}},me=Object.assign(de,{__name:"DepartmentUpsert",async setup(o){let s,l;const{data:r}=([s,l]=g(()=>D("record_status-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"properties",projection:{},filter:{property_type:{$eq:"record_status"}},limit:1e4},onResponse({request:t,response:a,options:p}){}}),"$KLWgsEOEsI")),s=await s,l(),s),{data:d}=([s,l]=g(()=>D("mark_as_delete-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"properties",projection:{},filter:{property_type:{$eq:"mark_as_delete"}},limit:1e4},onResponse({request:t,response:a,options:p}){}}),"$Bh0vhbAoug")),s=await s,l(),s);return(t,a)=>{const p=x;return t.isUpsertDepartmentVisible?(h(),c("section",V,[e("div",U,[R,e("div",j,[e("div",S,[e("div",B,[e("div",q,[e("header",A,[e("div",I,[M,e("div",N,[e("button",{onClick:a[0]||(a[0]=i=>t.closeDepartmentPanel()),"aria-label":"Close panel",class:"rounded-md bg-primary-700 text-primary-200 hover:text-white focus:outline-none focus:ring-2 focus:ring-white"},E)])]),Z]),t.progress?(h(),c("div",z,P)):u("",!0),t.progress?u("",!0):(h(),c("div",W,[e("div",F,[e("div",H,[e("form",{name:"frmDepartment",id:"frmDepartment",class:"space-y-8 divide-y divide-gray-200",onSubmit:a[5]||(a[5]=$((...i)=>t.upsertDepartment&&t.upsertDepartment(...i),["prevent"]))},[e("div",T,[e("div",G,[e("div",J,[e("div",K,[Q,e("div",X,[b(e("input",{type:"text",id:"name",name:"name","onUpdate:modelValue":a[1]||(a[1]=i=>t.data.name=i),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[v,t.data.name]])])]),e("div",Y,[ee,e("div",te,[b(e("input",{type:"text",id:"code",name:"code","onUpdate:modelValue":a[2]||(a[2]=i=>t.data.code=i),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[v,t.data.code]])]),se]),e("div",ae,[w(p,{data:{data:f(r).documents},onChange:t.handleSelectedInDepartment_record_status,show_label:"true",modelValue:t.data.record_status,"onUpdate:modelValue":a[3]||(a[3]=i=>t.data.record_status=i),name:"record_status",label:"Record Status",selected_value:t.data.record_status},null,8,["data","onChange","modelValue","selected_value"])]),e("div",oe,[w(p,{data:{data:f(d).documents},onChange:t.handleSelectedInDepartment_mark_as_delete,show_label:"true",modelValue:t.data.mark_as_delete,"onUpdate:modelValue":a[4]||(a[4]=i=>t.data.mark_as_delete=i),name:"mark_as_delete",label:"Mark for Deletion",selected_value:t.data.mark_as_delete},null,8,["data","onChange","modelValue","selected_value"])])])])])],32)])])]))]),e("div",ie,[ne,t.isDeleteButtonVisible?(h(),c("span",re,[e("button",{onClick:a[6]||(a[6]=i=>("useNuxtApp"in t?t.useNuxtApp:f(n))().$bus.$emit("evtDeleteDepartment",t.data)),type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-primary-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Delete")])):u("",!0),e("span",le,[e("button",{onClick:a[7]||(a[7]=(...i)=>t.upsertDepartment&&t.upsertDepartment(...i)),type:"submit",class:"zyn-button"},"Save")])])])])])])])):u("",!0)}}});export{me as default};
