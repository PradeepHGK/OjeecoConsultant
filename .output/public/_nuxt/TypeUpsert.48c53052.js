import{D as T}from"./Dropdownlist.1b365210.js";import{W as b,c,b as e,e as u,x as $,Z as g,aL as v,i as w,d as h,aM as m,w as k,v as l,ae as x,o as y,H as C}from"./entry.5eee13ba.js";import"./_plugin-vue_export-helper.c27b6911.js";const V={key:0,class:"fixed inset-0 overflow-hidden","aria-labelledby":"slide-over-title",role:"dialog","aria-modal":"true"},U={class:"absolute inset-0 overflow-hidden"},D=e("div",{class:"absolute inset-0","aria-hidden":"true"},null,-1),S={class:"absolute inset-y-0 right-0 pl-10 max-w-full flex"},j={class:"w-screen max-w-md"},M={class:"h-full divide-y divide-gray-200 flex flex-col bg-white shadow-xl"},B={class:"flex-1 h-0 overflow-y-auto"},N={class:"space-y-1 py-6 px-4 bg-primary-200 bg-opacity-50 sm:px-6"},R={class:"flex items-center justify-between space-x-3"},q=e("h2",{class:"text-lg leading-7 font-medium text-gray-700"},"Type",-1),A={class:"h-7 flex items-center"},I=e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),P=[I],z=e("div",null,[e("p",{class:"text-sm leading-5 text-gray-500"},"Create or update Type")],-1),O={key:0,class:"flex-1 flex flex-col justify-between"},Q=C('<div class="space-y-6 pt-6 pb-5"><div class="flex justify-center"><span class="inline-flex"><button type="button" class="inline-flex items-center px-6 py-3 text-base font-medium text-gray-600"><svg class="-ml-1 mr-3 h-5 w-5 animate-spin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true"><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing... </button></span></div></div>',1),H=[Q],L={key:1,class:"flex-1 flex flex-col justify-between"},Z={class:"px-4 divide-y divide-gray-200 sm:px-6"},E={class:"space-y-6 pt-6 pb-5"},F={class:"sm:overflow-hidden"},J={class:"bg-white space-y-6"},K={class:"grid grid-cols-1 gap-y-3 gap-x-4 sm:grid-cols-6"},W={class:"sm:col-span-6"},X=e("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Code",-1),Y={class:"mt-1"},G=e("p",{class:"mt-2 text-sm text-gray-500"},"Custom code used as unique constraint. If the same string exists will be thrown duplicate record error.",-1),ee={class:"sm:col-span-6"},te=e("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Name or Value",-1),se={class:"mt-1"},ae={class:"sm:col-span-6"},oe={class:"sm:col-span-6"},ie={class:"w-full flex-shrink-0 px-4 py-4 space-x-4 flex justify-end"},le=e("span",{class:"inline-flex rounded-md shadow-sm"},[e("button",{type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Reset")],-1),de={key:0,class:"inline-flex rounded-md shadow-sm"},ne={class:"inline-flex rounded-md shadow-sm"};let f="/api/types/";const re={components:{},data(){return{isUpsertTypeVisible:!1,isDeleteButtonVisible:!1,data:{},date:new Date,progress:!1}},methods:{getType(o){this.progress=!0;const{data:s}=m(f+o,{method:"post",initialCache:!1,onResponse({request:n,response:d,options:r}){console.log("Response from promise",d._data.document),this.data=d._data.document,this.progress=!1}},"$Qpf0Q2Pgee");k(s,()=>{console.log("Type = ",JSON.stringify(s)),this.data=s._rawValue.document,this.isDeleteButtonVisible=!0,this.progress=!1})},async upsertType(o){try{if(this.progress=!0,this.data._id===void 0){this.data.createdAt=l().$dayjs().utc(),this.data.updatedAt=l().$dayjs().utc();const{data:s}=await m(f+"create",{method:"post",body:this.data,initialCache:!1,onResponse({request:n,response:d,options:r}){d._data.insertedId&&l().$toast.show({type:"success",message:`Type [${d._data.insertedId}] added successfully`,timeout:6})}},"$QaBrtaDSzj")}else{const{data:s}=await m(f+this.data._id,{method:"put",body:_.omit(this.data,"_id"),initialCache:!1,onResponse({request:n,response:d,options:r}){d._data.modifiedCount>0&&l().$toast.show({type:"success",message:"Record has been updated successfully",timeout:6})}},"$NZSSyPbSj3")}this.progress=!1,l().$bus.$emit("evtSearchType",{filter:{},limit:10}),this.data={},this.isUpsertTypeVisible=!this.isUpsertTypeVisible}catch(s){console.log(s),this.progress=!1}finally{}},async deleteType(){try{await m("/api/types/"+this.data._id,{method:"delete",body:{},initialCache:!1,onResponse({request:o,response:s,options:n}){s._data.deletedCount==1?(console.log("deletedCount = ",s._data.deletedCount),l().$toast.show({type:"success",message:"Delete was successful",timeout:6}),this.progress=!1,this.isUpsertTypeVisible=!1,l().$bus.$emit("evtSearchType",{filter:{},limit:10}),this.data={}):(this.progress=!1,l().$toast.show({type:"error",message:"The delete failed...",timeout:6}))}},"$3fChmmK9eb")}catch{}finally{}},async closeTypePanel(){this.data={},this.isUpsertTypeVisible=!this.isUpsertTypeVisible},handleSelectedInType_record_status(o){this.data.record_status=o.target.value},handleSelectedInType_mark_as_delete(o){this.data.mark_as_delete=o.target.value}},created(){l().$bus.$on("evtUpsertType",o=>{o!==void 0&&this.getType(o._cells[0].data),this.isUpsertTypeVisible=!this.isUpsertTypeVisible}),l().$bus.$on("evtDeleteType",o=>{o!==void 0&&(this.data=o,this.deleteType())})},beforeDestroy(){l().$bus.$off("evtUpsertType"),l().$bus.$off("evtDeleteType")}},me=Object.assign(re,{__name:"TypeUpsert",async setup(o){let s,n;const{data:d}=([s,n]=b(()=>x("record_status-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"properties",projection:{},filter:{property_type:{$eq:"record_status"}},limit:1e4},onResponse({request:t,response:a,options:p}){}}),"$MnUB5MXw9b")),s=await s,n(),s),{data:r}=([s,n]=b(()=>x("mark_as_delete-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"properties",projection:{},filter:{property_type:{$eq:"mark_as_delete"}},limit:1e4},onResponse({request:t,response:a,options:p}){}}),"$yPfAwOrYUc")),s=await s,n(),s);return(t,a)=>{const p=T;return t.isUpsertTypeVisible?(y(),c("section",V,[e("div",U,[D,e("div",S,[e("div",j,[e("div",M,[e("div",B,[e("header",N,[e("div",R,[q,e("div",A,[e("button",{onClick:a[0]||(a[0]=i=>t.closeTypePanel()),"aria-label":"Close panel",class:"rounded-md bg-primary-700 text-primary-200 hover:text-white focus:outline-none focus:ring-2 focus:ring-white"},P)])]),z]),t.progress?(y(),c("div",O,H)):u("",!0),t.progress?u("",!0):(y(),c("div",L,[e("div",Z,[e("div",E,[e("form",{name:"frmType",id:"frmType",class:"space-y-8 divide-y divide-gray-200",onSubmit:a[5]||(a[5]=$((...i)=>t.upsertType&&t.upsertType(...i),["prevent"]))},[e("div",F,[e("div",J,[e("div",K,[e("div",W,[X,e("div",Y,[g(e("input",{type:"text",id:"code",name:"code","onUpdate:modelValue":a[1]||(a[1]=i=>t.data.code=i),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[v,t.data.code]])]),G]),e("div",ee,[te,e("div",se,[g(e("input",{type:"text",id:"name",name:"name","onUpdate:modelValue":a[2]||(a[2]=i=>t.data.name=i),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[v,t.data.name]])])]),e("div",ae,[w(p,{data:{data:h(d).documents},onChange:t.handleSelectedInType_record_status,show_label:"true",modelValue:t.data.record_status,"onUpdate:modelValue":a[3]||(a[3]=i=>t.data.record_status=i),name:"record_status",label:"Record Status",selected_value:t.data.record_status},null,8,["data","onChange","modelValue","selected_value"])]),e("div",oe,[w(p,{data:{data:h(r).documents},onChange:t.handleSelectedInType_mark_as_delete,show_label:"true",modelValue:t.data.mark_as_delete,"onUpdate:modelValue":a[4]||(a[4]=i=>t.data.mark_as_delete=i),name:"mark_as_delete",label:"Mark for Deletion",selected_value:t.data.mark_as_delete},null,8,["data","onChange","modelValue","selected_value"])])])])])],32)])])]))]),e("div",ie,[le,t.isDeleteButtonVisible?(y(),c("span",de,[e("button",{onClick:a[6]||(a[6]=i=>("useNuxtApp"in t?t.useNuxtApp:h(l))().$bus.$emit("evtDeleteType",t.data)),type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-primary-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Delete")])):u("",!0),e("span",ne,[e("button",{onClick:a[7]||(a[7]=(...i)=>t.upsertType&&t.upsertType(...i)),type:"submit",class:"zyn-button"},"Save")])])])])])])])):u("",!0)}}});export{me as default};
