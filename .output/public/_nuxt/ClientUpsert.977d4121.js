import{D as k}from"./Dropdownlist.1b365210.js";import{W as g,c as p,b as e,e as h,x as V,Z as r,aL as c,i as v,d as f,aM as b,w as $,v as l,ae as w,o as y,H as U}from"./entry.5eee13ba.js";import"./_plugin-vue_export-helper.c27b6911.js";const D={key:0,class:"fixed inset-0 overflow-hidden","aria-labelledby":"slide-over-title",role:"dialog","aria-modal":"true"},I={class:"absolute inset-0 overflow-hidden"},S=e("div",{class:"absolute inset-0","aria-hidden":"true"},null,-1),j={class:"absolute inset-y-0 right-0 pl-10 max-w-full flex"},M={class:"w-screen max-w-md"},N={class:"h-full divide-y divide-gray-200 flex flex-col bg-white shadow-xl"},R={class:"flex-1 h-0 overflow-y-auto"},q={class:"space-y-1 py-6 px-4 bg-primary-200 bg-opacity-50 sm:px-6"},A={class:"flex items-center justify-between space-x-3"},B=e("h2",{class:"text-lg leading-7 font-medium text-gray-700"},"Client",-1),P={class:"h-7 flex items-center"},z=e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),T=[z],W=e("div",null,[e("p",{class:"text-sm leading-5 text-gray-500"},"Manage client/supplier/vendor")],-1),Z={key:0,class:"flex-1 flex flex-col justify-between"},E=U('<div class="space-y-6 pt-6 pb-5"><div class="flex justify-center"><span class="inline-flex"><button type="button" class="inline-flex items-center px-6 py-3 text-base font-medium text-gray-600"><svg class="-ml-1 mr-3 h-5 w-5 animate-spin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true"><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing... </button></span></div></div>',1),H=[E],L={key:1,class:"flex-1 flex flex-col justify-between"},O={class:"px-4 divide-y divide-gray-200 sm:px-6"},F={class:"space-y-6 pt-6 pb-5"},Q={class:"sm:overflow-hidden"},G={class:"bg-white space-y-6"},J={class:"grid grid-cols-1 gap-y-3 gap-x-4 sm:grid-cols-6"},K=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-semibold text-gray-700"},"Client Information")],-1),X={class:"sm:col-span-6"},Y=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Name",-1),ee={class:"mt-1"},te={class:"sm:col-span-6"},se=e("label",{for:"website",class:"block text-sm font-medium text-gray-700"},"Website url",-1),ae={class:"mt-1"},oe=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-semibold text-gray-700"},"Address Information")],-1),ie={class:"sm:col-span-6"},le=e("label",{for:"address",class:"block text-sm font-medium text-gray-700"},"Street",-1),de={class:"mt-1"},ne={class:"sm:col-span-6"},re=e("label",{for:"apartment",class:"block text-sm font-medium text-gray-700"},"Apartment, suite, etc.",-1),ce={class:"mt-1"},ue={class:"sm:col-span-6"},me=e("label",{for:"city",class:"block text-sm font-medium text-gray-700"},"City",-1),pe={class:"mt-1"},he={class:"sm:col-span-3"},fe=e("label",{for:"region",class:"block text-sm font-medium text-gray-700"},"State / Province",-1),_e={class:"mt-1"},be={class:"sm:col-span-3"},ye=e("label",{for:"postal-code",class:"block text-sm font-medium text-gray-700"},"Postal code",-1),ge={class:"mt-1"},ve={class:"sm:col-span-6"},we=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-bold text-yellow-700"},"Record Information")],-1),Ce={class:"sm:col-span-6"},xe={class:"sm:col-span-6"},ke={class:"w-full flex-shrink-0 px-4 py-4 space-x-4 flex justify-end"},Ve=e("span",{class:"inline-flex rounded-md shadow-sm"},[e("button",{type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Reset")],-1),$e={key:0,class:"inline-flex rounded-md shadow-sm"},Ue={class:"inline-flex rounded-md shadow-sm"};let C="/api/clients/";const De={components:{},data(){return{isUpsertClientVisible:!1,isDeleteButtonVisible:!1,data:{},date:new Date,progress:!1}},methods:{getClient(i){this.progress=!0;const{data:o}=b(C+i,{method:"post",initialCache:!1,onResponse({request:d,response:n,options:m}){this.data=n._data.document,this.progress=!1}},"$wkd4k4M3i2");$(o,()=>{this.data=o._rawValue.document,this.data.address||(this.data.address={}),this.isDeleteButtonVisible=!0,this.progress=!1})},async upsertClient(i){try{if(this.progress=!0,this.data._id===void 0){this.data.createdAt=l().$dayjs().utc(),this.data.updatedAt=l().$dayjs().utc();const{data:o}=await b(C+"create",{method:"post",body:this.data,initialCache:!1,onResponse({request:d,response:n,options:m}){n._data.insertedId&&l().$toast.show({type:"success",message:`Client [${n._data.insertedId}] added successfully`,timeout:6})}},"$x52mVqIfNV")}else{const{data:o}=await b(C+this.data._id,{method:"put",body:_.omit(this.data,"_id"),initialCache:!1,onResponse({request:d,response:n,options:m}){n._data.modifiedCount>0&&l().$toast.show({type:"success",message:"Record has been updated successfully",timeout:6})}},"$bliP6VCWIg")}this.progress=!1,l().$bus.$emit("evtSearchClient",{filter:{},limit:10}),this.data={},this.isUpsertClientVisible=!this.isUpsertClientVisible}catch(o){console.log(o),this.progress=!1}finally{}},async deleteClient(){try{await b("/api/clients/"+this.data._id,{method:"delete",body:{},initialCache:!1,onResponse({request:i,response:o,options:d}){o._data.deletedCount==1?(l().$toast.show({type:"success",message:"Delete was successful",timeout:6}),this.progress=!1,this.isUpsertClientVisible=!1,l().$bus.$emit("evtSearchClient",{filter:{},limit:10}),this.data={}):(this.progress=!1,l().$toast.show({type:"error",message:"The delete failed...",timeout:6}))}},"$ugeVTsms1Q")}catch{}finally{}},async closeClientPanel(){this.data={},this.isUpsertClientVisible=!this.isUpsertClientVisible},handleSelectedInClient_record_status(i){this.data.record_status=i.target.value},handleSelectedInClient_mark_as_delete(i){this.data.mark_as_delete=i.target.value},handleSelectedInClient_country(i){this.data.country=i.target.value}},created(){l().$bus.$on("evtUpsertClient",i=>{i!==void 0?this.getClient(i._cells[0].data):this.data.address={},this.isUpsertClientVisible=!this.isUpsertClientVisible}),l().$bus.$on("evtDeleteClient",i=>{i!==void 0&&(this.data=i,this.deleteClient())})},beforeDestroy(){l().$bus.$off("evtUpsertClient"),l().$bus.$off("evtDeleteClient")}},Me=Object.assign(De,{__name:"ClientUpsert",async setup(i){let o,d;const{data:n}=([o,d]=g(()=>w("record_status-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"properties",projection:{},filter:{property_type:{$eq:"record_status"}},limit:1e4},onResponse({request:t,response:s,options:u}){}}),"$23IfdbOCmp")),o=await o,d(),o),{data:m}=([o,d]=g(()=>w("mark_as_delete-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"properties",projection:{},filter:{property_type:{$eq:"mark_as_delete"}},limit:1e4},onResponse({request:t,response:s,options:u}){}}),"$IfiR3mMej5")),o=await o,d(),o),{data:x}=([o,d]=g(()=>w("countries-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"countries",projection:{},filter:{},limit:1e4},onResponse({request:t,response:s,options:u}){}}),"$uZNNZdBEn9")),o=await o,d(),o);return(t,s)=>{const u=k;return t.isUpsertClientVisible?(y(),p("section",D,[e("div",I,[S,e("div",j,[e("div",M,[e("div",N,[e("div",R,[e("header",q,[e("div",A,[B,e("div",P,[e("button",{onClick:s[0]||(s[0]=a=>t.closeClientPanel()),"aria-label":"Close panel",class:"rounded-md bg-primary-700 text-primary-200 hover:text-white focus:outline-none focus:ring-2 focus:ring-white"},T)])]),W]),t.progress?(y(),p("div",Z,H)):h("",!0),t.progress?h("",!0):(y(),p("div",L,[e("div",O,[e("div",F,[e("form",{name:"frmClient",id:"frmClient",class:"space-y-8 divide-y divide-gray-200",onSubmit:s[11]||(s[11]=V((...a)=>t.upsertClient&&t.upsertClient(...a),["prevent"]))},[e("div",Q,[e("div",G,[e("div",J,[K,e("div",X,[Y,e("div",ee,[r(e("input",{type:"text",id:"name",name:"name","onUpdate:modelValue":s[1]||(s[1]=a=>t.data.name=a),class:"block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[c,t.data.name]])])]),e("div",te,[se,e("div",ae,[r(e("input",{type:"text",id:"website",name:"website","onUpdate:modelValue":s[2]||(s[2]=a=>t.data.website=a),class:"block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[c,t.data.website]])])]),oe,e("div",ie,[le,e("div",de,[r(e("input",{type:"text",id:"street",name:"street","onUpdate:modelValue":s[3]||(s[3]=a=>t.data.address.street=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[c,t.data.address.street]])])]),e("div",ne,[re,e("div",ce,[r(e("input",{type:"text",id:"apartment",name:"apartment","onUpdate:modelValue":s[4]||(s[4]=a=>t.data.address.apartment=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[c,t.data.address.apartment]])])]),e("div",ue,[me,e("div",pe,[r(e("input",{type:"text",id:"city",name:"city","onUpdate:modelValue":s[5]||(s[5]=a=>t.data.address.city=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[c,t.data.address.city]])])]),e("div",he,[fe,e("div",_e,[r(e("input",{type:"text",id:"state",name:"state","onUpdate:modelValue":s[6]||(s[6]=a=>t.data.address.state=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[c,t.data.address.state]])])]),e("div",be,[ye,e("div",ge,[r(e("input",{type:"text",id:"postal_code",name:"postal_code","onUpdate:modelValue":s[7]||(s[7]=a=>t.data.address.postal_code=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[c,t.data.address.postal_code]])])]),e("div",ve,[v(u,{data:{data:f(x).documents},onChange:t.handleSelectedInClient_country,show_label:"true",modelValue:t.data.address.country,"onUpdate:modelValue":s[8]||(s[8]=a=>t.data.address.country=a),name:"country",label:"Country",selected_value:t.data.address.country},null,8,["data","onChange","modelValue","selected_value"])]),we,e("div",Ce,[v(u,{data:{data:f(n).documents},onChange:t.handleSelectedInClient_record_status,show_label:"true",modelValue:t.data.record_status,"onUpdate:modelValue":s[9]||(s[9]=a=>t.data.record_status=a),name:"record_status",label:"Status",selected_value:t.data.record_status},null,8,["data","onChange","modelValue","selected_value"])]),e("div",xe,[v(u,{data:{data:f(m).documents},onChange:t.handleSelectedInClient_mark_as_delete,show_label:"true",modelValue:t.data.mark_as_delete,"onUpdate:modelValue":s[10]||(s[10]=a=>t.data.mark_as_delete=a),name:"mark_as_delete",label:"Mark for Deletion",selected_value:t.data.mark_as_delete},null,8,["data","onChange","modelValue","selected_value"])])])])])],32)])])]))]),e("div",ke,[Ve,t.isDeleteButtonVisible?(y(),p("span",$e,[e("button",{onClick:s[12]||(s[12]=a=>("useNuxtApp"in t?t.useNuxtApp:f(l))().$bus.$emit("evtDeleteClient",t.data)),type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-primary-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Delete")])):h("",!0),e("span",Ue,[e("button",{onClick:s[13]||(s[13]=(...a)=>t.upsertClient&&t.upsertClient(...a)),type:"submit",class:"zyn-button"},"Save")])])])])])])])):h("",!0)}}});export{Me as default};
