import{D as k}from"./Dropdownlist.1b365210.js";import{W as v,c as d,b as e,t as w,e as c,x as $,Z as u,aL as h,i as b,d as f,l as U,s as V,aM as g,w as D,v as i,j,ae as x,o as r,H as R}from"./entry.5eee13ba.js";import{C as I,_ as S}from"./index.79fffb63.js";import{a as B}from"./switch.ce1b5e48.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./dom.cb3029af.js";import"./label.0680d1f4.js";import"./description.3cfaa39b.js";import"./use-resolve-button-type.941463e9.js";const M={key:0,class:"fixed inset-0 overflow-hidden","aria-labelledby":"slide-over-title",role:"dialog","aria-modal":"true"},N={class:"absolute inset-0 overflow-hidden"},A=e("div",{class:"absolute inset-0","aria-hidden":"true"},null,-1),P={class:"absolute inset-y-0 right-0 pl-10 max-w-full flex"},q={class:"w-screen max-w-md"},F={class:"h-full divide-y divide-gray-200 flex flex-col bg-white shadow-xl"},z={class:"flex-1 h-0 overflow-y-auto"},O={class:"space-y-1 py-6 px-4 bg-primary-200 bg-opacity-50 sm:px-6"},T={class:"flex items-center justify-between space-x-3"},L=e("h2",{class:"text-lg leading-7 font-medium text-gray-700"},"Employee",-1),Y={class:"h-7 flex items-center"},H=e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),X=[H],Z={class:"text-sm leading-5 text-gray-500"},G={key:0,class:"flex-1 flex flex-col justify-between"},J=R('<div class="space-y-6 pt-6 pb-5"><div class="flex justify-center"><span class="inline-flex"><button type="button" class="inline-flex items-center px-6 py-3 text-base font-medium text-gray-600"><svg class="-ml-1 mr-3 h-5 w-5 animate-spin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true"><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing... </button></span></div></div>',1),K=[J],W={key:1,class:"flex-1 flex flex-col justify-between"},Q={class:"px-4 divide-y divide-gray-200 sm:px-6"},ee={class:"space-y-6 pt-6 pb-5"},se={class:"sm:overflow-hidden"},te={class:"bg-white space-y-6"},ae={class:"grid grid-cols-1 gap-y-3 gap-x-4 sm:grid-cols-6"},oe={key:0,class:"sm:col-span-6"},le={class:"space-y-4 sm:grid sm:grid-cols-3 sm:items-start sm:gap-6 sm:space-y-0"},ie={key:0,class:"aspect-w-3 aspect-h-2 sm:aspect-w-3 sm:aspect-h-4"},ne=["src","alt"],de={key:1,class:"aspect-w-3 aspect-h-2 sm:aspect-w-3 sm:aspect-h-4"},re=e("img",{class:"rounded-lg object-cover shadow-lg",src:"https://via.placeholder.com/100.png",alt:"Placeholder image"},null,-1),pe=[re],me={key:2,class:"sm:col-span-2"},ce={class:"space-y-4"},ue={class:"space-y-1 text-lg font-medium leading-6"},he={class:"text-primary-600"},fe=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-medium text-blue-gray-900"},"Personal Information")],-1),ye={class:"sm:col-span-6"},be=e("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"First Name",-1),_e={class:"mt-1"},ge={class:"sm:col-span-6"},ve=e("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Last Name",-1),we={class:"mt-1"},xe={class:"sm:col-span-6"},Ee=e("label",{for:"last_name",class:"block text-sm font-medium text-gray-700"},"Picture ",-1),Ve={class:"mt-1"},Ce={class:"sm:col-span-6"},ke=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1),$e={class:"mt-1"},Ue={class:"sm:col-span-6"},De=e("label",{for:"mobile_phone",class:"block text-sm font-medium text-gray-700"},"Mobile phone",-1),je={class:"mt-1"},Re=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-medium text-blue-gray-900"},"Professional Information")],-1),Ie={class:"sm:col-span-6"},Se={class:"sm:col-span-6"},Be=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-medium text-blue-gray-900"},"Client/Project Information")],-1),Me={class:"sm:col-span-6"},Ne=e("div",{class:"sm:col-span-3 mt-1"},[e("label",{for:"billable",class:"block text-sm font-medium text-gray-700"},"Billable")],-1),Ae={class:"sm:col-span-3"},Pe={class:"mt-1"},qe=e("span",{class:"sr-only"},"Billable",-1),Fe={class:"w-full flex-shrink-0 px-4 py-4 space-x-4 flex justify-end"},ze=e("span",{class:"inline-flex rounded-md shadow-sm"},[e("button",{type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Reset")],-1),Oe={key:0,class:"inline-flex rounded-md shadow-sm"},Te={class:"inline-flex rounded-md shadow-sm"};let E="/api/employees/";const Le={components:{Calendar:I,DatePicker:S},data(){return{isUpsertEmployeeVisible:!1,isDeleteButtonVisible:!1,data:{},date:new Date,progress:!1}},methods:{getEmployee(l){this.progress=!0;const{data:o}=g(E+l,{method:"post",initialCache:!1,onResponse({request:n,response:p,options:y}){this.data=p._data.document,this.progress=!1}},"$OetVO5ytl7");D(o,()=>{this.data=o._rawValue.document,this.isDeleteButtonVisible=!0,this.progress=!1})},async upsertEmployee(l){try{if(this.progress=!0,this.data._id===void 0){this.data.createdAt=i().$dayjs().utc(),this.data.updatedAt=i().$dayjs().utc();const{data:o}=await g(E+"create",{method:"post",body:this.data,initialCache:!1,onResponse({request:n,response:p,options:y}){p._data.insertedId&&i().$toast.show({type:"success",message:`Employee [${p._data.insertedId}] added successfully`,timeout:6})}},"$hFXhc3hzyV")}else{const{data:o}=await g(E+this.data._id,{method:"put",body:_.omit(this.data,"_id"),initialCache:!1,onResponse({request:n,response:p,options:y}){}},"$redmV7lYIE")}this.progress=!1,i().$bus.$emit("evtSearchEmployee",{filter:{},limit:10}),this.data={},this.isUpsertEmployeeVisible=!this.isUpsertEmployeeVisible}catch(o){console.log(o),this.progress=!1}finally{}},async deleteEmployee(){try{await g("/api/employees/"+this.data._id,{method:"delete",body:{},initialCache:!1,onResponse({request:l,response:o,options:n}){o._data.deletedCount==1?(console.log("deletedCount = ",o._data.deletedCount),i().$toast.show({type:"success",message:"Delete was successful",timeout:6})):i().$toast.show({type:"error",message:"The delete failed...",timeout:6}),this.progress=!1,i().$bus.$emit("evtSearchEmployee",{filter:{},limit:10}),this.data={},this.isUpsertEmployeeVisible=!this.isUpsertEmployeeVisible}},"$o4ZO6Vkfyn")}catch{}finally{}},async closeEmployeePanel(){this.data={},this.isUpsertEmployeeVisible=!this.isUpsertEmployeeVisible},handleSelectedInEmployeeDepartment(l){this.data.department=l.target.value},handleSelectedInEmployeeRole(l){this.data.role=l.target.value},handleSelectedInEmployeeClient(l){this.data.client=l.target.value}},created(){i().$bus.$on("evtUpsertEmployee",l=>{l!==void 0?this.getEmployee(l._cells[0].data):this.data.billable=j(!1),this.isUpsertEmployeeVisible=!this.isUpsertEmployeeVisible}),i().$bus.$on("evtDeleteEmployee",l=>{l!==void 0&&(this.data=l,this.deleteEmployee())})},beforeDestroy(){i().$bus.$off("evtUpsertEmployee"),i().$bus.$off("evtDeleteEmployee")}},es=Object.assign(Le,{__name:"EmployeeUpsert",async setup(l){let o,n;const{data:p}=([o,n]=v(()=>x("departments-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"departments",projection:{},filter:{},limit:1e4},onResponse({request:s,response:t,options:m}){}}),"$J1Rf4eF9T8")),o=await o,n(),o),{data:y}=([o,n]=v(()=>x("roles-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"roles",projection:{},filter:{},limit:1e4},onResponse({request:s,response:t,options:m}){}}),"$YYiRvjO0Fa")),o=await o,n(),o),{data:C}=([o,n]=v(()=>x("clients-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"clients",projection:{},filter:{},limit:1e4},onResponse({request:s,response:t,options:m}){}}),"$FhKsGT1X0u")),o=await o,n(),o);return(s,t)=>{const m=k;return s.isUpsertEmployeeVisible?(r(),d("section",M,[e("div",N,[A,e("div",P,[e("div",q,[e("div",F,[e("div",z,[e("header",O,[e("div",T,[L,e("div",Y,[e("button",{onClick:t[0]||(t[0]=a=>s.closeEmployeePanel()),"aria-label":"Close panel",class:"rounded-md bg-primary-700 text-primary-200 hover:text-white focus:outline-none focus:ring-2 focus:ring-white"},X)])]),e("div",null,[e("p",Z,"Create or update Employee "+w(s.data.billable),1)])]),s.progress?(r(),d("div",G,K)):c("",!0),s.progress?c("",!0):(r(),d("div",W,[e("div",Q,[e("div",ee,[e("form",{name:"frmEmployee",id:"frmEmployee",class:"space-y-8 divide-y divide-gray-200",onSubmit:t[10]||(t[10]=$((...a)=>s.upsertEmployee&&s.upsertEmployee(...a),["prevent"]))},[e("div",se,[e("div",te,[e("div",ae,[s.isDeleteButtonVisible?(r(),d("div",oe,[e("div",le,[s.data.profile_picture?(r(),d("div",ie,[e("img",{class:"rounded-lg object-cover shadow-lg",src:s.data.profile_picture,alt:s.data.last_name+" "+s.data.first_name},null,8,ne)])):(r(),d("div",de,pe)),s.data.first_name?(r(),d("div",me,[e("div",ce,[e("div",ue,[e("h3",null,w(s.data.last_name+","+s.data.first_name),1),e("p",he,w(s.data.role),1)])])])):c("",!0)])])):c("",!0),fe,e("div",ye,[be,e("div",_e,[u(e("input",{type:"text",id:"first_name",name:"first_name","onUpdate:modelValue":t[1]||(t[1]=a=>s.data.first_name=a),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[h,s.data.first_name]])])]),e("div",ge,[ve,e("div",we,[u(e("input",{type:"text",id:"last_name",name:"branchNameArabic","onUpdate:modelValue":t[2]||(t[2]=a=>s.data.last_name=a),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[h,s.data.last_name]])])]),e("div",xe,[Ee,e("div",Ve,[u(e("input",{type:"text",id:"profile_picture",name:"profile_picture","onUpdate:modelValue":t[3]||(t[3]=a=>s.data.profile_picture=a),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[h,s.data.profile_picture]])])]),e("div",Ce,[ke,e("div",$e,[u(e("input",{type:"text",id:"email",name:"email","onUpdate:modelValue":t[4]||(t[4]=a=>s.data.email=a),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[h,s.data.email]])])]),e("div",Ue,[De,e("div",je,[u(e("input",{type:"text",id:"mobile_phone",name:"mobile_phone","onUpdate:modelValue":t[5]||(t[5]=a=>s.data.mobile_phone=a),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[h,s.data.mobile_phone]])])]),Re,e("div",Ie,[b(m,{data:{data:f(p).documents},onChange:s.handleSelectedInEmployeeDepartment,modelValue:s.data.department,"onUpdate:modelValue":t[6]||(t[6]=a=>s.data.department=a),show_label:"true",name:"department",label:"Department",selected_value:s.data.department},null,8,["data","onChange","modelValue","selected_value"])]),e("div",Se,[b(m,{data:{data:f(y).documents},onChange:s.handleSelectedInEmployeeRole,modelValue:s.data.role,"onUpdate:modelValue":t[7]||(t[7]=a=>s.data.role=a),show_label:"true",name:"role",label:"Role",selected_value:s.data.role},null,8,["data","onChange","modelValue","selected_value"])]),Be,e("div",Me,[b(m,{data:{data:f(C).documents},onChange:s.handleSelectedInEmployeeClient,modelValue:s.data.client,"onUpdate:modelValue":t[8]||(t[8]=a=>s.data.client=a),show_label:"true",name:"client",label:"Client",selected_value:s.data.client},null,8,["data","onChange","modelValue","selected_value"])]),Ne,e("div",Ae,[e("div",Pe,[b(f(B),{modelValue:s.data.billable,"onUpdate:modelValue":t[9]||(t[9]=a=>s.data.billable=a),class:V([s.data.billable?"bg-primary-900":"bg-primary-700","relative inline-flex h-[38px] w-[74px] shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75"])},{default:U(()=>[qe,e("span",{"aria-hidden":"true",class:V([s.data.billable?"translate-x-9":"translate-x-0","pointer-events-none inline-block h-[34px] w-[34px] transform rounded-full bg-white shadow-lg ring-0 transition duration-200 ease-in-out"])},null,2)]),_:1},8,["modelValue","class"])])])])])])],32)])])]))]),e("div",Fe,[ze,s.isDeleteButtonVisible?(r(),d("span",Oe,[e("button",{onClick:t[11]||(t[11]=a=>("useNuxtApp"in s?s.useNuxtApp:f(i))().$bus.$emit("evtDeleteEmployee",s.data)),type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-primary-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Delete")])):c("",!0),e("span",Te,[e("button",{onClick:t[12]||(t[12]=(...a)=>s.upsertEmployee&&s.upsertEmployee(...a)),type:"submit",class:"zyn-button"},"Save")])])])])])])])):c("",!0)}}});export{es as default};
