import{V as o,j as f,W as g,M as h,c as y,b as r,v as i,aM as x,ae as b,o as v}from"./entry.5eee13ba.js";import{a as k,b as n}from"./mermaid.4b1cd600.js";const $={class:"px-4 sm:px-4 lg:px-4"},C=r("div",{class:"sm:flex sm:items-center"},null,-1),w={class:"mt-2 flex flex-col"},q={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},N={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},M={components:{},data(){return{data:[],filter:{}}},methods:{buildMongoQueryFilterCriteria(e){let s={};return _.isString(e.name)&&!i().$s.isBlank(e.name)&&(s.name={$regex:".*"+e.code+".*",$options:"i"}),_.isString(e.property_type)&&!i().$s.isBlank(e.property_type)&&(s.property_type={$eq:e.property_type}),_.isString(e.record_status)&&!i().$s.isBlank(e.record_status)&&(s.record_status={$eq:e.record_status}),_.isString(e.mark_as_delete)&&!i().$s.isBlank(e.mark_as_delete)&&(s.mark_as_delete={$eq:e.mark_as_delete}),s},async searchConfigurations(){this.progress=!0;try{let e=await x("/api/configurations",{method:"post",initialCache:!1,body:{projection:o("mongo_query").value.projection,filter:this.buildMongoQueryFilterCriteria(this.filter),limit:_.isNumber(this.filter.limit)?parseInt(this.filter.limit):1e4}},"$qYl1qJ88V4");setTimeout(()=>{o("grid").value.updateConfig({data:e.data._rawValue.documents}).forceRender(),this.progress=!1},2e3)}catch(e){this.progress=!1,i().$toast.show({type:"danger",message:e.message,timeout:6})}}},created(){i().$bus.$on("evtSearchConfiguration",e=>{this.filter=e,this.searchConfigurations()})}},R=Object.assign(M,{__name:"ConfigurationGrid",async setup(e){let s,l;const m="/api/configurations/",d=o("grid"),c=o("mongo_query",()=>({projection:{},filter:{},limit:999})),u=f(),{data:p}=([s,l]=g(()=>b("Configurations-list-"+Math.random,()=>$fetch(m,{initialCache:!1,method:"post",body:c.value,onResponse({request:t,response:a,options:B}){this.data=a._data.documents}}),"$bXv0JOcnmN")),s=await s,l(),s);return h(()=>{d.value=new k({columns:[{id:"_id",name:"Id.",hidden:!0},{id:"code",name:"Code"},{id:"name",name:"Name"},{id:"property_type",name:"Type"},{id:"record_status",name:"Record status",hidden:!0},{id:"mark_as_delete",name:"Mark for deletion?",hidden:!0},{name:"Status",data:t=>{let a=t.record_status?t.record_status.toLowerCase()=="active"?"text-blue-700 bg-blue-50":"text-gray-800 bg-gray-50":"";return n("span",{className:`inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium  ${a}`},t.record_status)},sort:!1,width:"25px"},{name:"Marked for delete?",data:t=>{let a=t.mark_as_delete&&t.mark_as_delete.toLowerCase()=="yes"?"text-red-700 bg-red-50":"";return n("span",{className:`inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium  ${a}`},t.mark_as_delete&&t.mark_as_delete.toLowerCase()=="yes"?"Deleted":"")},sort:!1,width:"25px"},{id:"btnEdit",name:"",formatter:(t,a)=>n("button",{className:"inline-flex items-center rounded-full border border-transparent bg-lime-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-lime-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",onClick:()=>i().$bus.$emit("evtUpsertConfiguration",a)},"Edit"),sort:!1,width:"50px"}],sort:!0,pagination:{enabled:!0,limit:25,summary:!0},className:{td:"whitespace-nowrap px-2 py-2 text-sm text-gray-500",table:"min-w-full divide-y divide-gray-300",thead:"bg-gray-50",th:"whitespace-nowrap px-2 py-3.5 text-left text-sm font-semibold text-gray-900"},search:!0,fixedHeader:!0,data:p._rawValue.documents}),d.value.render(u.value)}),(t,a)=>(v(),y("div",$,[C,r("div",w,[r("div",q,[r("div",N,[r("div",{ref_key:"gridRef",ref:u},null,512)])])])]))}});export{R as default};
