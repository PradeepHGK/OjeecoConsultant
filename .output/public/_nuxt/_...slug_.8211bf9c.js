import{_ as F}from"./ContentRendererMarkdown.ad11805f.js";import{_ as P}from"./layout.71555ab6.js";import{j as i,V as U,y as k,W as S,M as V,m as E,l as N,o as r,b as e,d as n,aI as T,c as p,t as f,e as $,Z as R,aL as j,x as A,i as I,$ as L}from"./entry.5eee13ba.js";import{p as _,e as q}from"./exportToPDF.465c687d.js";import"./highlighter.5e09c982.js";import"./path-meta.97a25ced.js";import"./slugify.e3037ea1.js";const H={class:"[usePropertiesStore().layout_width ? usePropertiesStore().layout_width : 'lg:max-w-7xl mx-auto']"},O={class:"mx-auto max-w-2xl px-4 sm:px-6 lg:max-w-7xl"},W={key:0,class:"relative isolate pt-16"},Z=e("div",{class:"absolute inset-0 -z-10 overflow-hidden","aria-hidden":"true"},[e("div",{class:"absolute left-16 top-full -mt-16 transform-gpu opacity-50 blur-3xl xl:left-1/2 xl:-ml-80"},[e("div",{class:"aspect-[1154/678] w-[72.125rem] bg-gradient-to-br from-[#FF80B5] to-[#9089FC]",style:{"clip-path":"polygon(100% 38.5%, 82.6% 100%, 60.2% 37.7%, 52.4% 32.1%, 47.5% 41.8%, 45.2% 65.6%, 27.5% 23.4%, 0.1% 35.3%, 17.9% 0%, 27.7% 23.4%, 76.2% 2.5%, 74.2% 56%, 100% 38.5%)"}})]),e("div",{class:"absolute inset-x-0 bottom-0 h-px bg-gray-900/5"})],-1),G={class:"mx-auto max-w-7xl px-4 py-10 sm:px-6 lg:px-8 bg-gradient-to-r from-pink-50 to-teal-100"},J={class:"mx-auto flex max-w-2xl items-center justify-between gap-x-8 lg:mx-0 lg:max-w-none"},K={class:"flex items-center gap-x-6"},Q={class:"flex items-center gap-x-4 sm:gap-x-6"},X={key:0,href:"#",class:"rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600"},Y=["onSubmit"],ee={class:"block w-full pt-2 pb-2"},te={class:"w-full zyn-button zyn-login-button zyn-button-contrast"},de={__name:"[...slug]",async setup(ae){let a,u;const o=i(null),s=i(!1),l=i(!1),t=U("page"),{path:m}=k();console.log("path = ",m.split("/").pop());const x=i(null);console.log("path = ",m);const v=m.split("/"),C=v[v.length-2],M=v.pop(),y=`${C}:${M}`,z=i(k().query.edit||!1);t.value||(t.value=([a,u]=S(()=>$fetch(`/api/cms/${y}`)),a=await a,u(),a),t.value.parsed=([a,u]=S(()=>_(t.value.body)),a=await a,u(),a)),t.value&&V(async()=>{t.value.parsed=await _(t.value.body)});async function h(){s.value=!0,await L(),o.value.focus(),g()}function g(){o.value&&(o.value.style.height="5px",o.value.style.height=`${o.value.scrollHeight}px`)}function b(){!s.value||l.value||(l.value=!0,$fetch(`/api/cms/${y}`,{method:"PUT",body:t.value.body}).then(async()=>{t.value.parsed=await _(t.value.body),s.value=l.value=!1}).catch(d=>{s.value=l.value=!1,alert(d.data.message)}))}return(d,c)=>{const B=F,D=P;return r(),E(D,{name:"landing"},{default:N(()=>[e("div",H,[e("div",O,[("useSupabaseUser"in d?d.useSupabaseUser:n(T))().value&&z.value?(r(),p("header",W,[Z,e("div",G,[e("div",J,[e("div",K,[e("a",{href:"#",onClick:c[0]||(c[0]=w=>n(q)(`${n(t).parsed.title}.pdf`,x.value,void 0,{html2canvas:{margin:1,scale:.5,width:793.92,height:1122.24,useCORS:!0}})),class:"rounded-md px-3 py-2 text-sm font-semiboldtransition-all duration-300 zyn-nav-action-button-bordered"},"Export to PDF")]),e("div",Q,[e("a",{href:"#",onClick:h,class:"rounded-md px-3 py-2 text-sm font-semiboldtransition-all duration-300 zyn-nav-action-button-bordered"},f(s.value?"Editing":"Edit")+" this page",1),s.value?(r(),p("a",X,f(l.value?"Saving":"Save"),1)):$("",!0)])])])])):$("",!0),e("div",{onDblclick:h},[s.value?(r(),p("form",{key:0,class:"editor-wrapper",onSubmit:A(b,["prevent"])},[R(e("textarea",{"onUpdate:modelValue":c[1]||(c[1]=w=>n(t).body=w),ref_key:"editor",ref:o,onBlur:b,onInput:g},null,544),[[j,n(t).body]]),e("div",ee,[e("button",te,f(l.value?"Saving":"Save"),1)])],40,Y)):(r(),p("div",{key:1,ref_key:"pdfSection",ref:x},[I(B,{value:n(t).parsed,class:"p-2"},null,8,["value"])],512))],32)])])]),_:1})}}};export{de as default};
