import{V as f,j as l,v as a,W as v,ae as p,M as y,c as w,b as r,o as b}from"./entry.5eee13ba.js";import{a as $,b as h}from"./mermaid.4b1cd600.js";import{f as U,j as k}from"./join.4243fb1a.js";import{t as N}from"./toString.53aed50c.js";import"./_arrayEach.0e9334a0.js";import"./_baseEach.ed2de8af.js";const C={class:"px-4 sm:px-4 lg:px-4"},E={class:"mt-2 flex flex-col"},q={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},A={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},K={__name:"UsersGrid",async setup(B){let s,d;const i="/api/profiles",m=f("grid"),o=l(!1),n=l("");a().$bus.$on("evtSearchUsers",t=>{g(t)});const c=l(),{data:x}=([s,d]=v(()=>p("Users-list-"+Math.random,()=>$fetch(i,{initialCache:!1,method:"get"}),"$KyBk0P6cJ7")),s=await s,d(),s);async function g(t){if(o.value=!0,t){const e=[];U(t,function(u,_){N(u)!=""&&e.push(_+"=eq."+u)}),n.value=k(e,"&")}console.log(`query = [${i}?${n.value}]`);try{let e=await p("Users-list-"+Math.random,()=>$fetch(`${i}?${n.value}`,{initialCache:!1,method:"get"}),"$eKszkA73vl");f("grid").value.updateConfig({data:e.data._rawValue}).forceRender(),o.value=!1}catch(e){o.value=!1,a().$toast.show({type:"danger",message:e.message,timeout:6})}}return y(()=>{m.value=new $({columns:[{id:"id",name:"Id.",width:"50px",hidden:!0},{id:"email",name:"Email",width:"50px"},{id:"first_name",name:"First Name",width:"50px"},{id:"last_name",name:"Last Name",width:"50px"},{id:"btnDelete",name:"",formatter:(t,e)=>h("button",{className:"inline-flex items-center rounded-full border border-transparent bg-red-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",onClick:()=>a().$bus.$emit("evtDeleteUser",e)},"Delete"),sort:!1,width:"10px"},{id:"btnEdit",name:"",formatter:(t,e)=>h("button",{className:"inline-flex items-center rounded-full border border-transparent bg-lime-600 px-3 py-1.5 text-xs font-medium text-white shadow-sm hover:bg-lime-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",onClick:()=>a().$bus.$emit("evtUpsertUser",e)},"Edit"),sort:!1,width:"50px"}],sort:!0,pagination:{enabled:!0,limit:10,summary:!0},className:{td:"whitespace-nowrap px-2 py-2 text-sm text-gray-500",table:"min-w-full divide-y divide-gray-300",thead:"bg-gray-50",th:"whitespace-nowrap px-2 py-3.5 text-left text-sm font-semibold text-gray-900"},search:!0,fixedHeader:!0,data:x.value}),m.value.render(c.value)}),(t,e)=>(b(),w("div",C,[r("div",E,[r("div",q,[r("div",A,[r("div",{ref_key:"gridRef",ref:c},null,512)])])])]))}};export{K as default};
