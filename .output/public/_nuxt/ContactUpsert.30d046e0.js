import{D as $}from"./Dropdownlist.1b365210.js";import{W as p,c as h,b as e,e as f,x as U,Z as c,aL as u,i as y,d as m,aM as C,w as S,v as n,ae as b,o as g,H as I}from"./entry.5eee13ba.js";import"./_plugin-vue_export-helper.c27b6911.js";const D={key:0,class:"fixed inset-0 overflow-hidden","aria-labelledby":"slide-over-title",role:"dialog","aria-modal":"true"},M={class:"absolute inset-0 overflow-hidden"},j=e("div",{class:"absolute inset-0","aria-hidden":"true"},null,-1),A={class:"absolute inset-y-0 right-0 pl-10 max-w-full flex"},R={class:"w-screen max-w-md"},q={class:"h-full divide-y divide-gray-200 flex flex-col bg-white shadow-xl"},B={class:"flex-1 h-0 overflow-y-auto"},N={class:"space-y-1 py-6 px-4 bg-primary-200 bg-opacity-50 sm:px-6"},P={class:"flex items-center justify-between space-x-3"},T=e("h2",{class:"text-lg leading-7 font-medium text-gray-700"},"Contact",-1),E={class:"h-7 flex items-center"},F=e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),H=[F],z=e("div",null,[e("p",{class:"text-sm leading-5 text-gray-500"},"Create or update Contact")],-1),G={key:0,class:"flex-1 flex flex-col justify-between"},L=I('<div class="space-y-6 pt-6 pb-5"><div class="flex justify-center"><span class="inline-flex"><button type="button" class="inline-flex items-center px-6 py-3 text-base font-medium text-gray-600"><svg class="-ml-1 mr-3 h-5 w-5 animate-spin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" aria-hidden="true"><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing... </button></span></div></div>',1),W=[L],Z={key:1,class:"flex-1 flex flex-col justify-between"},J={class:"px-4 divide-y divide-gray-200 sm:px-6"},K={class:"space-y-6 pt-6 pb-5"},O={class:"sm:overflow-hidden"},Q={class:"bg-white space-y-6"},X={class:"grid grid-cols-1 gap-y-3 gap-x-4 sm:grid-cols-6"},Y=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-medium text-primary-700"},"Contact Information ")],-1),ee={class:"sm:col-span-6"},te=e("label",{for:"first_name",class:"block text-sm font-medium text-gray-700"},"Name",-1),se={class:"mt-1"},ae=e("p",{class:"mt-2 text-sm text-gray-500"},"Name of the contact person",-1),oe={class:"sm:col-span-6"},le=e("label",{for:"email",class:"block text-sm font-medium text-gray-700"},"Email",-1),ie={class:"mt-1"},ne={class:"sm:col-span-6"},de=e("label",{for:"mobile_phone",class:"block text-sm font-medium text-gray-700"},"Mobile phone",-1),re={class:"mt-1"},ce=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-medium text-primary-700"},"Address Information ")],-1),ue={class:"sm:col-span-6"},me=e("label",{for:"address",class:"block text-sm font-medium text-gray-700"},"Street",-1),pe={class:"mt-1"},he={class:"sm:col-span-6"},fe=e("label",{for:"apartment",class:"block text-sm font-medium text-gray-700"},"Apartment, suite, etc.",-1),ye={class:"mt-1"},_e={class:"sm:col-span-6"},be=e("label",{for:"city",class:"block text-sm font-medium text-gray-700"},"City",-1),ge={class:"mt-1"},ve={class:"sm:col-span-3"},Ce=e("label",{for:"region",class:"block text-sm font-medium text-gray-700"},"State / Province",-1),we={class:"mt-1"},xe={class:"sm:col-span-3"},ke=e("label",{for:"postal-code",class:"block text-sm font-medium text-gray-700"},"Postal code",-1),Ve={class:"mt-1"},$e={class:"sm:col-span-6"},Ue=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-medium text-primary-700"},"Contact Type Information")],-1),Se={class:"sm:col-span-6"},Ie={key:0,class:"sm:col-span-6"},De=e("div",{class:"sm:col-span-6"},[e("h2",{class:"font-medium text-primary-700"},"Record Information ")],-1),Me={class:"sm:col-span-6"},je={class:"sm:col-span-6"},Ae={class:"w-full flex-shrink-0 px-4 py-4 space-x-4 flex justify-end"},Re=e("span",{class:"inline-flex rounded-md shadow-sm"},[e("button",{type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Reset")],-1),qe={key:0,class:"inline-flex rounded-md shadow-sm"},Be={class:"inline-flex rounded-md shadow-sm"};let w="/api/contacts/";const Ne={components:{},data(){return{isUpsertContactVisible:!1,isDeleteButtonVisible:!1,data:{},date:new Date,progress:!1}},methods:{getContact(l){this.progress=!0;const{data:o}=C(w+l,{method:"post",initialCache:!1,onResponse({request:i,response:r,options:v}){console.log("Response from promise",r._data.document),this.data=r._data.document,this.progress=!1}},"$fGki5BWR5j");S(o,()=>{this.data=o._rawValue.document,this.data.address||(this.data.address={}),this.isDeleteButtonVisible=!0,this.progress=!1})},async upsertContact(l){try{if(this.progress=!0,this.data._id===void 0){this.data.createdAt=n().$dayjs().utc(),this.data.updatedAt=n().$dayjs().utc();const{data:o}=await C(w+"create",{method:"post",body:this.data,initialCache:!1,onResponse({request:i,response:r,options:v}){r._data.insertedId&&n().$toast.show({type:"success",message:`Contact [${r._data.insertedId}] added successfully`,timeout:6})}},"$SS6ETNGw2k")}else{const{data:o}=await C(w+this.data._id,{method:"put",body:_.omit(this.data,"_id"),initialCache:!1,onResponse({request:i,response:r,options:v}){r._data.modifiedCount>0&&n().$toast.show({type:"success",message:"Record has been updated successfully",timeout:6})}},"$LqnJ0pPFFi")}this.progress=!1,n().$bus.$emit("evtSearchContact",{filter:{},limit:10}),this.data={},this.isUpsertContactVisible=!this.isUpsertContactVisible}catch(o){console.log(o),this.progress=!1}finally{}},async deleteContact(){try{await C("/api/contacts/"+this.data._id,{method:"delete",body:{},initialCache:!1,onResponse({request:l,response:o,options:i}){o._data.deletedCount==1?(console.log("deletedCount = ",o._data.deletedCount),n().$toast.show({type:"success",message:"Delete was successful",timeout:6}),this.progress=!1,this.isUpsertContactVisible=!1,n().$bus.$emit("evtSearchContact",{filter:{},limit:10}),this.data={}):(this.progress=!1,n().$toast.show({type:"error",message:"The delete failed...",timeout:6}))}},"$diiQH6NNad")}catch{}finally{}},async closeContactPanel(){this.data={},this.isUpsertContactVisible=!this.isUpsertContactVisible},handleSelectedInContact_record_status(l){this.data.record_status=l.target.value},handleSelectedInContact_mark_as_delete(l){this.data.mark_as_delete=l.target.value},handleSelectedInContact_country(l){this.data.country=l.target.value},handleSelectedInContact_contact_type(l){this.data.contact_type=l.target.value,this.data.contact_type!="Active Client"&&(this.data.client=null)},handleSelectedInConsultantClient(l){this.data.client=l.target.value}},created(){n().$bus.$on("evtUpsertContact",l=>{l!==void 0?this.getContact(l._cells[0].data):this.data.address={},this.isUpsertContactVisible=!this.isUpsertContactVisible}),n().$bus.$on("evtDeleteContact",l=>{l!==void 0&&(this.data=l,this.deleteContact())})},beforeDestroy(){n().$bus.$off("evtUpsertContact"),n().$bus.$off("evtDeleteContact")}},Fe=Object.assign(Ne,{__name:"ContactUpsert",async setup(l){let o,i;const{data:r}=([o,i]=p(()=>b("record_status-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"properties",projection:{},filter:{property_type:{$eq:"record_status"}},limit:1e4},onResponse({request:t,response:s,options:d}){}}),"$6IFdhyEAWm")),o=await o,i(),o),{data:v}=([o,i]=p(()=>b("mark_as_delete-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"properties",projection:{},filter:{property_type:{$eq:"mark_as_delete"}},limit:1e4},onResponse({request:t,response:s,options:d}){}}),"$BGBBEHM1oN")),o=await o,i(),o),{data:x}=([o,i]=p(()=>b("countries-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"countries",projection:{},filter:{},limit:1e4},onResponse({request:t,response:s,options:d}){}}),"$5FM8U0UuLZ")),o=await o,i(),o),{data:k}=([o,i]=p(()=>b("contact_types-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"configurations",projection:{},filter:{property_type:{$eq:"Contact Type"}},limit:1e4},onResponse({request:t,response:s,options:d}){}}),"$XHMafIwkS6")),o=await o,i(),o),{data:V}=([o,i]=p(()=>b("clients-list-"+Math.random,()=>$fetch("/api/generic",{initialCache:!1,method:"post",body:{collection:"clients",projection:{},filter:{},limit:1e4},onResponse({request:t,response:s,options:d}){}}),"$Kzg1SpGBAv")),o=await o,i(),o);return(t,s)=>{const d=$;return t.isUpsertContactVisible?(g(),h("section",D,[e("div",M,[j,e("div",A,[e("div",R,[e("div",q,[e("div",B,[e("header",N,[e("div",P,[T,e("div",E,[e("button",{onClick:s[0]||(s[0]=a=>t.closeContactPanel()),"aria-label":"Close panel",class:"rounded-md bg-primary-700 text-primary-200 hover:text-white focus:outline-none focus:ring-2 focus:ring-white"},H)])]),z]),t.progress?(g(),h("div",G,W)):f("",!0),t.progress?f("",!0):(g(),h("div",Z,[e("div",J,[e("div",K,[e("form",{name:"frmContact",id:"frmContact",class:"space-y-8 divide-y divide-gray-200",onSubmit:s[14]||(s[14]=U((...a)=>t.upsertContact&&t.upsertContact(...a),["prevent"]))},[e("div",O,[e("div",Q,[e("div",X,[Y,e("div",ee,[te,e("div",se,[c(e("input",{type:"text",id:"name",name:"name","onUpdate:modelValue":s[1]||(s[1]=a=>t.data.name=a),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[u,t.data.name]])]),ae]),e("div",oe,[le,e("div",ie,[c(e("input",{type:"text",id:"email",name:"email","onUpdate:modelValue":s[2]||(s[2]=a=>t.data.email=a),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[u,t.data.email]])])]),e("div",ne,[de,e("div",re,[c(e("input",{type:"text",id:"mobile_phone",name:"mobile_phone","onUpdate:modelValue":s[3]||(s[3]=a=>t.data.mobile_phone=a),class:"py-3 px-4 block w-full pl-5 focus:ring-lime-600 focus:border-lime-600 border-gray-300"},null,512),[[u,t.data.mobile_phone]])])]),ce,e("div",ue,[me,e("div",pe,[c(e("input",{type:"text",id:"street",name:"street","onUpdate:modelValue":s[4]||(s[4]=a=>t.data.address.street=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[u,t.data.address.street]])])]),e("div",he,[fe,e("div",ye,[c(e("input",{type:"text",id:"apartment",name:"apartment","onUpdate:modelValue":s[5]||(s[5]=a=>t.data.address.apartment=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[u,t.data.address.apartment]])])]),e("div",_e,[be,e("div",ge,[c(e("input",{type:"text",id:"city",name:"city","onUpdate:modelValue":s[6]||(s[6]=a=>t.data.address.city=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[u,t.data.address.city]])])]),e("div",ve,[Ce,e("div",we,[c(e("input",{type:"text",id:"state",name:"state","onUpdate:modelValue":s[7]||(s[7]=a=>t.data.address.state=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[u,t.data.address.state]])])]),e("div",xe,[ke,e("div",Ve,[c(e("input",{type:"text",id:"postal_code",name:"postal_code","onUpdate:modelValue":s[8]||(s[8]=a=>t.data.address.postal_code=a),class:"block w-full border-gray-300 shadow-sm focus:ring-lime-600 focus:border-lime-600 sm:text-sm"},null,512),[[u,t.data.address.postal_code]])])]),e("div",$e,[y(d,{data:{data:m(x).documents},onChange:t.handleSelectedInClient_country,show_label:"true",modelValue:t.data.address.country,"onUpdate:modelValue":s[9]||(s[9]=a=>t.data.address.country=a),name:"country",label:"Country",selected_value:t.data.address.country},null,8,["data","onChange","modelValue","selected_value"])]),Ue,e("div",Se,[y(d,{data:{data:m(k).documents},onChange:t.handleSelectedInContact_contact_type,show_label:"true",modelValue:t.data.contact_type,"onUpdate:modelValue":s[10]||(s[10]=a=>t.data.contact_type=a),name:"contact_type",label:"Type",selected_value:t.data.contact_type},null,8,["data","onChange","modelValue","selected_value"])]),t.data.contact_type=="Active Client"?(g(),h("div",Ie,[y(d,{data:{data:m(V).documents},onChange:t.handleSelectedInConsultantClient,modelValue:t.data.client,"onUpdate:modelValue":s[11]||(s[11]=a=>t.data.client=a),show_label:"true",name:"client",label:"Client",selected_value:t.data.client},null,8,["data","onChange","modelValue","selected_value"])])):f("",!0),De,e("div",Me,[y(d,{data:{data:m(r).documents},onChange:t.handleSelectedInContact_record_status,show_label:"true",modelValue:t.data.record_status,"onUpdate:modelValue":s[12]||(s[12]=a=>t.data.record_status=a),name:"record_status",label:"Status",selected_value:t.data.record_status},null,8,["data","onChange","modelValue","selected_value"])]),e("div",je,[y(d,{data:{data:m(v).documents},onChange:t.handleSelectedInContact_mark_as_delete,show_label:"true",modelValue:t.data.mark_as_delete,"onUpdate:modelValue":s[13]||(s[13]=a=>t.data.mark_as_delete=a),name:"mark_as_delete",label:"Mark for Deletion",selected_value:t.data.mark_as_delete},null,8,["data","onChange","modelValue","selected_value"])])])])])],32)])])]))]),e("div",Ae,[Re,t.isDeleteButtonVisible?(g(),h("span",qe,[e("button",{onClick:s[15]||(s[15]=a=>("useNuxtApp"in t?t.useNuxtApp:m(n))().$bus.$emit("evtDeleteContact",t.data)),type:"button",class:"py-2 px-4 border border-gray-300 text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-primary-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out"},"Delete")])):f("",!0),e("span",Be,[e("button",{onClick:s[16]||(s[16]=(...a)=>t.upsertContact&&t.upsertContact(...a)),type:"submit",class:"zyn-button"},"Save")])])])])])])])):f("",!0)}}});export{Fe as default};
