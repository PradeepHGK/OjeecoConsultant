import{_ as G}from"./Biw8V7Zo.js";import{_ as H}from"./CDiO6N6g.js";import{J as K,r as u,m as W,I as X,g as Y,w as L,o as n,a as e,b as N,k as o,d as z,c as r,C as v,F as b,l as $,t as g,n as T,i as Z,x as M,B as ee}from"./DQim9pRB.js";import{s as te,T as se}from"./CwrT1Aom.js";import"./DoIMxQcI.js";const oe={class:"bg-white mt-8 p-4 lg:p-0"},ae={class:"flex box-border border-2"},le={class:"gap-y-3 p-4 lg:p-0"},ne={class:"box-border border-2 rounded-lg"},ie={class:"mx-auto max-w-7xl p-8 relative"},re={key:0,class:"absolute top-0 left-0 z-30 w-full h-full bg-gray-100 bg-opacity-75 transition-opacity"},ce=e("div",{class:"h-full bg-gray-100 bg-opacity-75 transition-opacity"},null,-1),de=[ce],ue={key:1,class:"animate-spin absolute top-1/2 left-1/2 z-40"},fe=e("svg",{class:"h-8 w-8 text-zinc-800",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),he=[fe],me={key:2},pe=e("div",{class:"sm:flex sm:items-center"},[e("div",{class:"sm:flex-auto"},[e("h1",{class:"text-base font-semibold leading-6 text-gray-900"},"Query Results"),e("p",{class:"mt-2 text-sm text-gray-700"},"DuckDB SQL query execution results")]),e("div",{class:"mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},[e("button",{type:"button",class:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},"Export")])],-1),ve={class:"mt-8 flow-root"},ge={class:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},_e={class:"inline-block min-w-full align-middle sm:px-6 lg:px-8 max-h-96"},xe={class:"min-w-full divide-y divide-gray-300"},ye={class:"bg-white border-b sticky top-0"},be={class:"divide-y divide-gray-200 bg-white h-96 overflow-y-auto"},we=e("td",{class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-0"},null,-1),ke={key:0,class:"mt-4 hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"},Ce={class:"text-sm text-gray-700"},ze={class:"font-medium"},$e={class:"font-medium"},Me={class:"font-medium"},Pe={class:"inline-flex -space-x-px rounded-md shadow-sm","aria-label":"Pagination",id:"nav_pagination"},Be=e("span",{class:"sr-only"},"Previous",-1),Te=e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z","clip-rule":"evenodd"})],-1),De=[Be,Te],Fe=["id","onClick"],Le=e("span",{class:"sr-only"},"Next",-1),Ne=e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z","clip-rule":"evenodd"})],-1),Re=[Le,Ne],Se=e("div",null," ",-1),_=25,Ae=10,Qe={__name:"sql-ide",setup(je){const R=[te()],f=K();u(!1);const S=u(!1),m=u(!1),A=t=>{f.value=t.view},j=t=>{w.value=t},q=t=>{},I=t=>{},E=()=>{x(),f.value&&f.value.dispatch({changes:{from:0,to:f.value.state.doc.length,insert:""}})},V=()=>{const t=f.value?f.value.state.doc.toString():"";w.value=t,x(),D(1)},x=()=>{P.value=[],d=1,y.value=0,k.value={},C.value=[],p.value=[]},O=W(()=>!f.value||f.value.state.doc.length===0),w=u(""),P=u([]);let d=1;const y=u(0),k=u({}),C=u([]),p=u([]),D=async t=>{if(m.value=!0,!O.value)try{S.value=!0;const a={method:"POST",headers:{"Content-Type":"application/json"},body:{query:w.value}},l=await $fetch(`${Z().public.API_BASE_URL}/execute-query`,a);if(l)if(l.data&&Array.isArray(l.data)){const c=(t-1)*_,s=c+_;P.value=l.data.slice(c,s),k.value=l,d=t;const i=l.total_rows;y.value=Math.ceil(i/_),C.value=Object.keys(l.data[0]).map(h=>({label:M().$s.humanize(h),field:h})),p.value=Array.from({length:y.value},(h,F)=>F+1),Q(d,i),m.value=!1}else console.error("Inside error"),M().$toast.show({type:"danger",message:`${l.error}`,position:"top-left",timeout:2e3}),m.value=!1,x();else M().$toast.show({type:"danger",message:"No response from server",position:"top-left",timeout:2e3}),m.value=!1,x()}catch(a){console.error(a),M().$toast.show({type:"danger",error:a,message:`${a}`,position:"top-left",timeout:2e3}),m.value=!1,x()}},Q=(t,a)=>{const l=Math.ceil(a/_),c=Math.min(l,Ae),s=Math.floor(c/2);let i=Math.max(1,t-s),h=Math.min(l,t+s);h-i+1>c&&(t<=s?h=i+c-1:l-t<s?i=l-c+1:(i=t-Math.floor(c/2),h=i+c-1)),p.value=Array.from({length:h-i+1},(F,U)=>i+U)},J=t=>{const a="relative inline-flex items-center px-4 py-2 text-sm font-semibold ring-1 ring-inset ring-gray-300 focus:outline-offset-0";return t===d?`${a} bg-indigo-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600`:`${a} text-gray-900 hover:bg-gray-50 focus:z-20 focus:outline-offset-0`},B=async t=>{t<1||t>p.length||D(t)};return X(()=>{}),(t,a)=>{const l=G,c=H;return n(),Y(c,{name:"landing"},{default:L(()=>[e("div",oe,[e("div",ae,[N(l,{placeholder:"Codemirror Loading..."},{default:L(()=>[N(o(se),{value:o(w),onReady:A,onChange:j,onFocus:q,onBlur:I,placeholder:"Select * from users limit 25",style:{height:"200px",width:"100%"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:R},null,8,["value"])]),_:1})]),e("footer",{class:"flex justify-end py-4"},[e("button",{onClick:E,class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4"},"Clear"),z("   "),e("button",{onClick:V,class:"bg-primary-500 hover:bg-primary-700 text-white font-bold py-2 px-4"},"Run")])]),e("div",le,[e("div",ne,[e("div",ie,[o(m)?(n(),r("div",re,de)):v("",!0),o(m)?(n(),r("div",ue,he)):v("",!0),o(p).length>0?(n(),r("div",me,[pe,e("div",ve,[e("div",ge,[e("div",_e,[e("table",xe,[e("thead",ye,[e("tr",null,[(n(!0),r(b,null,$(o(C),s=>(n(),r("th",{scope:"col",key:s.field,class:"sticky top-0 z-10 border-b border-gray-300 py-3.5 whitespace-nowrap px-4 text-left text-sm font-semibold text-zinc-600 sm:pl-0"},g(s.label),1))),128))])]),e("tbody",be,[(n(!0),r(b,null,$(o(P),s=>(n(),r("tr",{key:s.id},[(n(!0),r(b,null,$(o(C),i=>(n(),r("td",{key:i.field,class:"whitespace-nowrap text-left text-sm text-zinc-600"},g(s[i.field]),1))),128)),we]))),128))])])])])])])):v("",!0)])]),o(p).length>0?(n(),r("div",ke,[e("div",null,[e("p",Ce,[z(" Showing "),e("span",ze,g(t.$s.numberFormat((o(d)-1)*_+1,0,".",",")),1),z(" to "),e("span",$e,g(t.$s.numberFormat(Math.min(o(d)*_,o(k).total_rows),0,".",",")),1),z(" of "),e("span",Me,g(t.$s.numberFormat(o(k).total_rows,0,".",",")),1)])]),e("div",null,[e("nav",Pe,[e("a",{href:"#",onClick:a[0]||(a[0]=T(s=>B(o(d)-1),["prevent"])),id:"prev_page",class:"relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"},De),(n(!0),r(b,null,$(o(p),s=>(n(),r(b,null,[s<=o(y)?(n(),r("a",{key:s,href:"#",class:ee(J(s)),id:`pg_${s}`,onClick:T(i=>B(s),["prevent"])},g(s),11,Fe)):v("",!0)],64))),256)),o(d)<o(y)?(n(),r("a",{key:0,href:"#",onClick:a[1]||(a[1]=T(s=>B(o(d)+1),["prevent"])),id:"next_page",class:"relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"},Re)):v("",!0)])])])):v("",!0),Se])]),_:1})}}};export{Qe as default};
