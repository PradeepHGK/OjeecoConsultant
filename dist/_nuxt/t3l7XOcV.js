import{y as x,am as S,X as A,m,W as j,L,an as T,ao as g,ap as q,aq as I,ar as V,as as $,o as E,g as W,k as F}from"./DQim9pRB.js";import{h as v,f as K,a as P}from"./Bp47c7wY.js";const b="default",O=/^@|^v-on:/,B=/^:|^v-bind:/,R=/^v-model/,z=["select","textarea","input"],U=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(t=>[t,`prose-${t}`])),X=x({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})}},async setup(t){var i,s,a,p,l,u,f,_;const e=(a=(s=(i=S())==null?void 0:i.appContext)==null?void 0:s.app)==null?void 0:a.$nuxt,n=(e==null?void 0:e.$route)||(e==null?void 0:e._route),{mdc:o}=((p=e==null?void 0:e.$config)==null?void 0:p.public)||{},r={...(l=o==null?void 0:o.components)!=null&&l.prose&&t.prose!==!1?U:{},...((u=o==null?void 0:o.components)==null?void 0:u.map)||{},...A(((_=(f=t.data)==null?void 0:f.mdc)==null?void 0:_.components)||{}),...t.components},c=m(()=>{var C;const N=(((C=t.body)==null?void 0:C.children)||[]).map(d=>d.tag||d.type).filter(d=>!v.includes(d));return Array.from(new Set(N)).sort().join(".")});return await nt(t.body,{tags:r}),{tags:r,contentKey:c,route:n}},render(t){var l,u,f;const{tags:e,tag:n,body:o,data:r,contentKey:c,route:i}=t;if(!o)return null;const s={...r,tags:e,$route:i},a=n!==!1?h(n||((l=s.component)==null?void 0:l.name)||s.component||"div"):void 0,p=w(o,j,s,s);return a?j(a,{...(u=s.component)==null?void 0:u.props,...this.$attrs,key:c},p):(f=p.default)==null?void 0:f.call(p)}});function G(t,e,n,o={}){if(t.type==="text")return e(g,t.value);if(t.type==="comment")return e(I,null,t.value);const r=t.tag,c=D(t,n.tags);if(t.tag==="binding")return H(t,e,n,o);const i=h(c);typeof i=="object"&&(i.tag=r);const s=J(t,n);return e(i,s,w(t,e,n,{...o,...s}))}function H(t,e,n,o={}){var p,l;const r={...o,$document:n,$doc:n},c=/\.|\[(\d+)\]/,s=((p=t.props)==null?void 0:p.value.trim().split(c).filter(Boolean)).reduce((u,f)=>{if(u&&f in u)return typeof u[f]=="function"?u[f]():u[f]},r),a=(l=t.props)==null?void 0:l.defaultValue;return e(g,s??a??"")}function w(t,e,n,o){const c=(t.children||[]).reduce((s,a)=>{if(!tt(a))return s[b].push(a),s;const p=k(a);return s[p]=s[p]||[],a.type==="element"&&s[p].push(...a.children||[]),s},{[b]:[]});return Object.entries(c).reduce((s,[a,p])=>(p.length&&(s[a]=()=>{const l=p.map(u=>G(u,e,n,o));return et(l)}),s),{})}function J(t,e){const{tag:n="",props:o={}}=t;return Object.keys(o).reduce(function(r,c){if(c==="__ignoreMap")return r;const i=o[c];if(R.test(c)&&!z.includes(n))return M(c,i,r,e);if(c==="v-bind")return Q(c,i,r,e);if(O.test(c))return Y(c,i,r,e);if(B.test(c))return Z(c,i,r,e);const{attribute:s}=K(P,c);return Array.isArray(i)&&i.every(a=>typeof a=="string")?(r[s]=i.join(" "),r):(r[s]=i,r)},{})}function M(t,e,n,o){const r=u=>+u,c=u=>u.trim(),i=u=>u,s=t.replace(R,"").split(".").filter(u=>u).reduce((u,f)=>(u[f]=!0,u),{}),a="value",p=s.lazy?"change":"input",l=s.number?r:s.trim?c:i;return n[a]=y(e,o),n.on=n.on||{},n.on[p]=u=>o[e]=l(u),n}function Q(t,e,n,o){const r=y(e,o);return n=Object.assign(n,r),n}function Y(t,e,n,o){return t=t.replace(O,""),n.on=n.on||{},n.on[t]=()=>y(e,o),n}function Z(t,e,n,o){return t=t.replace(B,""),n[t]=y(e,o),n}const h=t=>{if(!v.includes(t)&&!(t!=null&&t.render)&&!(t!=null&&t.ssrRender)){const e=L(T(t),!1);if(typeof e=="object")return e}return t};function y(t,e){const n=t.split(".").reduce((o,r)=>typeof o=="object"?o[r]:void 0,e);return typeof n>"u"?V(t):n}function k(t){let e="";for(const n of Object.keys(t.props||{}))if(!(!n.startsWith("#")&&!n.startsWith("v-slot:"))){e=n.split(/[:#]/,2)[1];break}return e||b}function tt(t){return t.tag==="template"}function et(t){const e=[];for(const n of t){const o=e[e.length-1];n.type===g&&(o==null?void 0:o.type)===g?o.children=o.children+n.children:e.push(n)}return e}async function nt(t,e){if(!t)return;const n=Array.from(new Set(o(t,e)));await Promise.all(n.map(async r=>{if(r!=null&&r.render||r!=null&&r.ssrRender||r!=null&&r.__ssrInlineRender)return;const c=h(r);c!=null&&c.__asyncLoader&&!c.__asyncResolved&&await c.__asyncLoader()}));function o(r,c){const i=r.tag;if(r.type==="text"||i==="binding"||r.type==="comment")return[];const s=D(r,c.tags),a=[];r.type!=="root"&&!v.includes(s)&&a.push(s);for(const p of r.children||[])a.push(...o(p,c));return a}}function D(t,e){var o;const n=t.tag;return!n||typeof((o=t.props)==null?void 0:o.__ignoreMap)<"u"?n:e[n]||e[T(n)]||e[q(t.tag)]||n}const st=x({__name:"ContentRendererMarkdown",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})}},setup(t){const e=t,n=$().isEnabled(),o=m(()=>{let i=e.value.body||e.value;return e.excerpt&&e.value.excerpt&&(i=e.value.excerpt),i}),r=m(()=>{const{body:i,excerpt:s,...a}=e.value;return{...a,...e.data}}),c=m(()=>({...e.components,...r.value._components||{}}));return(i,s)=>{const a=X;return E(),W(a,{body:o.value,data:r.value,tag:t.tag,components:c.value,"data-content-id":F(n)?t.value._id:void 0},null,8,["body","data","tag","components","data-content-id"])}}});export{st as _};
