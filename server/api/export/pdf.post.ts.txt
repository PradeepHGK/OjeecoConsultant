import {convertWordFiles} from "convert-multiple-files";

export default defineEventHandler(async (event) => {
	//Get request payload
	const body = await readBody(event); // only for POST | PUT | PATCH | DELETE requests
	const docx_path = body.docx_path;
	const dest_path = body.dest_path;
	let res_message = "";

	//Validate whether the input are available and in the expected format
	if (docx_path == undefined || docx_path == "") {
		res_message = "docx_path is invalid or missing";
	}

	if (dest_path == undefined || dest_path == "") {
		res_message = "dest_path path is invalid or missing";
	}
	if (res_message != "") {
		return {
			status: "Failure",
			message: res_message,
		};
	}
	//Business logic to generate word file from the template and data passed.
	try {
		const pathOutput = await convertWordFiles("/Users/nathansweb/Desktop/senthil-lh.docx", "pdf", "/Users/nathansweb/zynomi/zytes");
		return pathOutput;
	} catch (e) {
		event.res.statusCode = 500;
		return {
			status: "Failure",
			exception: e,
			message: `Failure during docx to pdf conversion`,
		};
	}
});
